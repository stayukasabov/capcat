<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Development Documentation</title>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Development Documentation</title>
    <link rel="stylesheet" href="../../css/design-system.css">
    <link rel="stylesheet" href="../../css/main.css">
</head>
<body>
    <!-- Header -->
    <div id="header-placeholder"></div>


    <div class="doc-container">
        <div class="container">
            <div class="doc-content">

<div class="nav-breadcrumb"><a href="../index.html">Documentation Home</a> / development</div>
<h1>Development Documentation</h1>

<h2>Overview</h2>

<p>This directory contains comprehensive technical documentation for Capcat developers, including architecture details, design patterns, implementation logic, and team onboarding materials.</p>



<h2>Document Index</h2>

<h3>1. Architecture &amp; Logic</h3>
<h4>File</h4> <code>01-architecture-logic.md</code>

<h4>Purpose</h4> Complete technical architecture explanation for junior developers

<h4>Contents</h4>
<ul>
<li>System architecture layers (UI, orchestration, source, processing, output)</li>
<li>Hybrid source system (config-driven vs custom)</li>
<li>Core design patterns (Factory, Registry, Strategy, Session Pooling, Observer)</li>
<li>Complete data flow diagrams</li>
<li>Error handling strategy</li>
<li>Performance optimizations</li>
<li>Security considerations</li>
<li>Configuration management</li>
</ul>

<h4>Target Audience</h4> Junior developers, new team members, code reviewers

<h4>Key Concepts</h4>
<ul>
<li>Hybrid architecture supporting 2 source types</li>
<li>Registry pattern for source discovery</li>
<li>Factory pattern for source instantiation</li>
<li>Graceful degradation on errors</li>
<li>Connection pooling for performance</li>
</ul>

<h4>Code Examples</h4> 30+ real code snippets with explanations



<h3>2. Team Onboarding</h3>
<h4>File</h4> <code>02-team-onboarding.md</code>

<h4>Purpose</h4> Complete onboarding guide for new developers and designers

<h4>Contents</h4>
<ul>
<li>Day 1: Environment setup and verification</li>
<li>Day 1-2: Codebase exploration exercises</li>
<li>Day 3-4: First contribution tasks</li>
<li>Week 1: Deep dive sessions (architecture, user interface, testing)</li>
<li>Week 2: Collaboration practices (code review, git workflow)</li>
<li>Development workflows (adding sources, fixing bugs)</li>
<li>Common tasks and debugging tips</li>
<li>Success checklist and next steps</li>
</ul>

<h4>Target Audience</h4> New team members (developers)

<h4>Time Estimate</h4>
<ul>
<li>Setup: 30 minutes</li>
<li>Codebase exploration: 2 days</li>
<li>First contribution: 3-4 days</li>
<li>Full onboarding: 2 weeks</li>
</ul>

<h4>Learning Path</h4>
<ol>
<li>Environment setup → Working Capcat installation</li>
<li>Code exploration → Understanding architecture</li>
<li>Small contributions → Confidence building</li>
<li>Independent work → Full productivity</li>
</ol>



<h2>How to Use This Documentation</h2>

<h3>For New Developers</h3>

<h4>Week 1 Roadmap</h4>

<h4>Day 1: Setup</h4> (2-4 hours)
<pre><code># Follow setup in 02-team-onboarding.md
git clone &lt;repo&gt;
./scripts/fix_dependencies.sh
./capcat list sources  # Verify installation
</code></pre>

<h4>Day 2: Architecture</h4> (4-6 hours)
<ol>
<li>Read <code>01-architecture-logic.md</code> sections 1-3</li>
<li>Draw architecture diagram from memory</li>
<li>Complete Exercise 2: Trace code flow</li>
<li>Review design patterns section</li>
</ol>

<h4>Day 3: First Contribution</h4> (4-6 hours)
<ol>
<li>Pick Task 1 or 2 from onboarding guide</li>
<li>Add config-driven source or fix documentation</li>
<li>Create pull request</li>
<li>Iterate based on feedback</li>
</ol>

<h4>Day 4-5: Deep Understanding</h4> (8-10 hours)
<ol>
<li>Complete all hands-on exercises</li>
<li>Add custom source (if comfortable with Python)</li>
<li>Write tests for your contribution</li>
<li>Attend deep dive sessions</li>
</ol>

<h3>For Experienced Developers</h3>

<h4>Quick Reference</h4>

<h4>Adding New Source</h4>
<ul>
<li>Config-driven: See &quot;Adding a New Config-Driven Source&quot; in onboarding doc</li>
<li>Custom: See &quot;Adding a New Custom Source&quot; + Architecture patterns in logic doc</li>
</ul>

<h4>Understanding Data Flow</h4>
<ul>
<li>Section &quot;Complete Article Fetching Flow&quot; in <code>01-architecture-logic.md</code></li>
<li>Follow execution: CLI → Registry → Factory → Source → Processing → Output</li>
</ul>

<h4>Debugging Issues</h4>
<ul>
<li>&quot;Debugging Tips&quot; section in onboarding doc</li>
<li>&quot;Error Handling Strategy&quot; in architecture doc</li>
<li>Use <code>--debug</code> flag for verbose logging</li>
</ul>

<h4>Code Review Guidelines</h4>
<ul>
<li>&quot;Code Review Guidelines&quot; in onboarding doc</li>
<li>Check against design patterns in architecture doc</li>
</ul>

<h3>For Product Designers</h3>

<h4>Understanding Technical Constraints</h4>

<ol>
<li><h4>Why Hybrid Architecture?</h4></li>
<ul>
<li>Read: <code>01-architecture-logic.md</code> &quot;Hybrid Source Layer&quot; section</li>
</ol>
<ul>
<li>Understand: Config-driven (simple, 30min) vs Custom (complex, 4hr)</li>
<li>Implication: Feature complexity affects development time</li>
</ul>

<ol>
<li><h4>Why CLI First?</h4></li>
<ul>
<li>Read: Architecture decisions</li>
</ol>
<ul>
<li>Understand: Automation, scriptability, power users</li>
<li>Implication: GUI is secondary, not primary interface</li>
</ul>

<ol>
<li><h4>Performance Constraints</h4></li>
<ul>
<li>Read: &quot;Performance Optimizations&quot; in architecture doc</li>
</ol>
<ul>
<li>Understand: Network I/O is bottleneck</li>
<li>Implication: Bulk operations faster than individual</li>
</ul>

<ol>
<li><h4>Privacy Architecture</h4></li>
<ul>
<li>Read: &quot;Security Considerations&quot; in architecture doc</li>
</ol>
<ul>
<li>Understand: Local-first, no telemetry by design</li>
<li>Implication: Analytics limited, user research critical</li>
</ul>

<h4>Collaboration Points</h4>
<ul>
<li>Feature feasibility discussion</li>
<li>Technical constraints awareness</li>
<li>Implementation time estimates</li>
<li>Interface vs technical tradeoffs</li>
</ul>

<h3>For Code Reviewers</h3>

<h4>Review Checklist</h4> (from onboarding doc):

<h4>Architecture Compliance</h4>
<ul>
<li>[ ] Follows established patterns (Factory, Registry, Strategy)</li>
<li>[ ] Fits into layer architecture (doesn&#x27;t violate boundaries)</li>
<li>[ ] Reuses existing components (no reinventing wheel)</li>
<li>[ ] Maintains separation of concerns</li>
</ul>

<h4>Code Quality</h4>
<ul>
<li>[ ] PEP 8 compliant</li>
<li>[ ] Docstrings present and clear</li>
<li>[ ] No code duplication</li>
<li>[ ] Single responsibility principle</li>
</ul>

<h4>Testing</h4>
<ul>
<li>[ ] Unit tests for new functions</li>
<li>[ ] Integration tests for workflows</li>
<li>[ ] Edge cases covered</li>
<li>[ ] Tests actually test what they claim</li>
</ul>

<h4>Documentation</h4>
<ul>
<li>[ ] README updated if user-facing change</li>
<li>[ ] Architecture doc updated if structural change</li>
<li>[ ] API reference updated if interface change</li>
<li>[ ] Comments explain &quot;why&quot; not &quot;what&quot;</li>
</ul>



<h2>Architecture Overview</h2>

<h3>System Layers</h3>

<div class="ascii-art">┌─────────────────────────────────────┐
│     USER INTERFACES                 │  cli.py, interactive.py
├─────────────────────────────────────┤
│     CORE ORCHESTRATION              │  capcat.py, config.py
├─────────────────────────────────────┤
│     SOURCE SYSTEM                   │  Registry, Factory, Sources
├─────────────────────────────────────┤
│     CONTENT PROCESSING              │  Fetcher, MediaProcessor
├─────────────────────────────────────┤
│     OUTPUT GENERATION               │  FileWriter, HTMLGenerator
└─────────────────────────────────────┘
</div>

<h3>Key Components</h3>

<h4>Source System</h4>
<ul>
<li><code>SourceRegistry</code>: Auto-discovers sources from filesystem</li>
<li><code>SourceFactory</code>: Creates appropriate source instance</li>
<li><code>BaseSource</code>: Abstract base for all sources</li>
<li><code>ConfigDrivenSource</code>: YAML-based simple sources</li>
<li>Custom sources: Python implementations</li>
</ul>

<h4>Processing Pipeline</h4>
<ol>
<li>Article discovery (Source.get_articles)</li>
<li>Content fetching (ArticleFetcher)</li>
<li>Media processing (UnifiedMediaProcessor)</li>
<li>Format conversion (HTMLConverter)</li>
<li>File generation (FileWriter)</li>
</ol>

<h4>Design Patterns</h4>
<ul>
<li>Factory: Source creation</li>
<li>Registry: Source discovery</li>
<li>Strategy: Content extraction</li>
<li>Observer: Progress tracking</li>
<li>Singleton: Session pooling</li>
</ul>



<h2>Development Workflows</h2>

<h3>Quick Reference</h3>

<h4>Add Config Source</h4> (30 min):
<pre><code># Create YAML config
cat &gt; sources/active/config_driven/configs/source.yaml &lt;&lt;EOF
display_name: &quot;Source Name&quot;
base_url: &quot;https://example.com/&quot;
category: tech
article_selectors: [&quot;.headline a&quot;]
content_selectors: [&quot;.article-body&quot;]
EOF

# Test
./capcat fetch source --count 5
</code></pre>

<h4>Add Custom Source</h4> (4 hrs):
<pre><code># Create structure
mkdir -p sources/active/custom/source
cd sources/active/custom/source

# Create source.py (implement BaseSource)
# Create config.yaml
# Create __init__.py

# Test and commit
</code></pre>

<h4>Fix Bug</h4>
<ol>
<li>Write failing test</li>
<li>Fix code</li>
<li>Verify test passes</li>
<li>Run full test suite</li>
<li>Commit with &quot;fix:&quot; prefix</li>
</ol>

<h4>Add Feature</h4>
<ol>
<li>Discuss with team</li>
<li>Update architecture doc if needed</li>
<li>Implement with tests</li>
<li>Update user docs</li>
<li>Create PR with detailed description</li>
</ol>



<h2>Code Organization</h2>

<h3>Directory Structure</h3>

<div class="ascii-art">Application/
├── capcat.py              # Main application
├── cli.py                 # CLI interface
├── core/                  # Core modules
│   ├── source_system/     # Source management
│   │   ├── source_registry.py
│   │   ├── source_factory.py
│   │   ├── base_source.py
│   │   └── config_driven_source.py
│   ├── article_fetcher.py
│   ├── unified_media_processor.py
│   └── config.py
├── sources/
│   └── active/
│       ├── config_driven/
│       │   └── configs/*.yaml
│       └── custom/
│           └── */source.py
├── tests/                 # Test suite
├── docs/                  # Documentation
│   ├── tutorials/        # User and exhaustive tutorials
│   └── development/      # This directory
└── scripts/              # Utility scripts
</div>

<h3>Import Conventions</h3>

<pre><code># Standard library
import os
import sys
from typing import List, Dict

# Third-party
import requests
import yaml
from bs4 import BeautifulSoup

# Local modules
from core.config import get_config
from core.source_system.base_source import BaseSource
from core.exceptions import SourceError
</code></pre>

<h3>Naming Conventions</h3>

<h4>Files</h4> <code>lowercase_with_underscores.py</code>
<h4>Classes</h4> <code>PascalCase</code>
<h4>Functions</h4> <code>lowercase_with_underscores</code>
<h4>Constants</h4> <code>UPPERCASE_WITH_UNDERSCORES</code>
<h4>Private</h4> <code>_leading_underscore</code>



<h2>Testing Strategy</h2>

<h3>Test Types</h3>

<h4>Unit Tests</h4> (Fast, isolated):
<pre><code># Test individual functions
def test_slugify():
    assert slugify(&quot;Hello World&quot;) == &quot;hello_world&quot;
    assert slugify(&quot;Test@#$123&quot;) == &quot;test_123&quot;
</code></pre>

<h4>Integration Tests</h4> (Medium speed, component interaction):
<pre><code># Test component interactions
def test_source_registry_and_factory():
    registry = SourceRegistry()
    source = registry.get_source(&#x27;hn&#x27;)
    articles = source.get_articles(count=5)
    assert len(articles) == 5
</code></pre>

<h4>End-to-End Tests</h4> (Slow, full workflow):
<pre><code># Test complete user workflows
def test_fetch_command_workflow():
    result = run_capcat(&quot;fetch hn --count 5&quot;)
    assert result.success
    assert output_exists()
</code></pre>

<h3>Coverage Goals</h3>

<ul>
<li>Core modules: 90%+</li>
<li>Sources: 80%+</li>
<li>CLI: 70%+</li>
<li>Overall: 85%+</li>
</ul>

<h3>Running Tests</h3>

<pre><code># All tests
pytest

# With coverage
pytest --cov=core --cov=sources

# Specific module
pytest tests/test_source_registry.py

# Watch mode (re-run on change)
ptw
</code></pre>



<h2>Common Patterns</h2>

<h3>Error Handling</h3>

<pre><code>try:
    result = operation()
except SpecificError as e:
    logger.error(f&quot;Operation failed: {e}&quot;)
    return default_value
except Exception as e:
    logger.exception(&quot;Unexpected error&quot;)
    raise
</code></pre>

<h3>Logging</h3>

<pre><code>logger = get_logger(__name__)

logger.debug(&quot;Detailed debug info&quot;)
logger.info(&quot;User-relevant information&quot;)
logger.warning(&quot;Something unexpected&quot;)
logger.error(&quot;Operation failed&quot;)
logger.exception(&quot;Error with traceback&quot;)
</code></pre>

<h3>Configuration</h3>

<pre><code># Get configuration
config = get_config()
count = config.get(&#x27;default_count&#x27;, 30)

# Respect CLI override
if args.count:
    count = args.count
</code></pre>



<h2>Performance Guidelines</h2>

<h3>Do&#x27;s</h3>

<ul>
<li>Use session pooling for HTTP requests</li>
<li>Parallelize independent operations</li>
<li>Cache expensive computations</li>
<li>Use generators for large datasets</li>
<li>Lazy load when possible</li>
</ul>

<h3>Don&#x27;ts</h3>

<ul>
<li>Don&#x27;t create new sessions per request</li>
<li>Don&#x27;t process serially when can parallelize</li>
<li>Don&#x27;t load entire files into memory</li>
<li>Don&#x27;t make unnecessary network calls</li>
<li>Don&#x27;t ignore timeouts</li>
</ul>

<h3>Example Optimization</h3>

<pre><code># Bad: Sequential processing
for article in articles:
    content = fetch_content(article.url)  # Slow
    process(content)

# Good: Parallel processing
from concurrent.futures import ThreadPoolExecutor

with ThreadPoolExecutor(max_workers=10) as executor:
    contents = executor.map(fetch_content, article_urls)
    for content in contents:
        process(content)
</code></pre>



<h2>Security Guidelines</h2>

<h3>Input Validation</h3>

<pre><code>def validate_count(count):
    if not 1 &lt;= count &lt;= 1000:
        raise ValidationError(&quot;Count must be 1-1000&quot;)
    return count
</code></pre>

<h3>Path Sanitization</h3>

<pre><code>def sanitize_path(path):
    # Remove path traversal
    path = path.replace(&#x27;..&#x27;, &#x27;&#x27;)
    # Remove absolute paths
    path = path.lstrip(&#x27;/&#x27;)
    return path
</code></pre>

<h3>No Secrets in Code</h3>

<pre><code># Bad
API_KEY = &quot;secret_key_12345&quot;

# Good
API_KEY = os.getenv(&#x27;CAPCAT_API_KEY&#x27;)
if not API_KEY:
    raise ConfigError(&quot;API_KEY not set&quot;)
</code></pre>



<h2>Related Documentation</h2>

<h3>User Documentation</h3>

<ul>
<li><h4>Quick Start</h4> <code>../quick-start.md</code></li>
<li><h4>Getting Started Tutorial</h4> <code>../tutorials/user/01-getting-started.md</code></li>
<li><h4>Architecture</h4> <code>../architecture.md</code></li>
<li><h4>Source Development</h4> <code>../source-development.md</code></li>
<li><h4>Testing Guide</h4> <code>../testing.md</code></li>
</ul>

<h3>API Documentation</h3>

<ul>
<li><h4>API Reference</h4> <code>../api-reference.md</code></li>
<li><h4>Module Docs</h4> <code>../api/</code></li>
</ul>



<h2>Contributing</h2>

<h3>Before Starting Work</h3>

<ol>
<li>Check existing issues and PRs</li>
<li>Discuss significant changes with team</li>
<li>Read relevant documentation</li>
<li>Understand user impact</li>
</ol>

<h3>Development Process</h3>

<ol>
<li>Create feature branch</li>
<li>Write failing tests</li>
<li>Implement feature</li>
<li>Make tests pass</li>
<li>Update documentation</li>
<li>Create pull request</li>
<li>Address review feedback</li>
<li>Merge when approved</li>
</ol>

<h3>Code Review Process</h3>

<ol>
<li>Self-review checklist</li>
<li>Automated checks (CI)</li>
<li>Peer review (2 approvals)</li>
<li>Architecture review (for significant changes)</li>
<li>UX review (for user-facing changes)</li>
</ol>



<h2>Resources</h2>

<h3>Internal</h3>

<ul>
<li><h4>Codebase</h4> GitHub repository</li>
<li><h4>Documentation</h4> <code>docs/</code> directory</li>
<li><h4>Examples</h4> <code>examples/</code> directory</li>
<li><h4>Tests</h4> <code>tests/</code> directory</li>
</ul>

<h3>External</h3>

<ul>
<li><h4>Python</h4> https://docs.python.org/3/</li>
<li><h4>BeautifulSoup</h4> https://www.crummy.com/software/BeautifulSoup/</li>
<li><h4>Requests</h4> https://requests.readthedocs.io/</li>
<li><h4>Pytest</h4> https://docs.pytest.org/</li>
</ul>



<h2>Contact</h2>

<h4>Tech Lead</h4> [Name]
<h4>Senior Developer</h4> [Name]
<h4>DevOps</h4> [Name]

<h4>Channels</h4>
<ul>
<li>Slack: #capcat-dev</li>
<li>Email: dev-team@example.com</li>
<li>Office hours: Tue/Thu 2-3pm</li>
</ul>



<h2>Quick Command Reference</h2>

<pre><code># Setup
./scripts/fix_dependencies.sh

# Run Capcat
./capcat fetch hn --count 10

# Tests
pytest
pytest --cov

# Code quality
black .
flake8 core/ sources/

# Documentation
python3 scripts/run_docs.py

# Debug mode
./capcat --debug fetch hn --count 1
</code></pre>



<h4>Last Updated</h4> 2025-01-06
<h4>Next Review</h4> Quarterly
<h4>Owner</h4> Tech Lead
<h4>Status</h4> Active, living documentation


<script type="module">
  import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
    mermaid.initialize({
    startOnLoad: true,
    theme: 'base',
    themeVariables: {
      // Primary colors from design system (Capcat orange palette)
      primaryColor: '#FFD4B7',           // --orange-200
      primaryTextColor: '#201419',       // --ink
      primaryBorderColor: '#F1540E',     // --orange-500 / --accent-primary

      // Line and edge colors
      lineColor: '#58444c',              // --ink-medium

      // Secondary colors
      secondaryColor: '#FFEADB',         // --orange-100
      tertiaryColor: '#f9f8ed',          // --accent-cream-primary

      // Text colors
      textColor: '#201419',              // --ink
      mainBkg: '#FAF8EE',                // --cream

      // Node styling
      nodeBorder: '#F1540E',             // --accent-primary
      clusterBkg: '#faf2e7',             // --accent-cream-light
      clusterBorder: '#D44400',          // --orange-600 / --accent-hover

      // Font
      fontFamily: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif',
      fontSize: '16px'
    },
    flowchart: {
      nodeSpacing: 50,
      rankSpacing: 50,
      padding: 15,
      useMaxWidth: true,
      htmlLabels: true,
      curve: 'basis'
    }
  });

  // Add copy buttons to Mermaid diagrams after rendering
  document.addEventListener('DOMContentLoaded', function() {
    const mermaidDivs = document.querySelectorAll('.mermaid');

    mermaidDivs.forEach(function(mermaidDiv) {
      // Get the original Mermaid source code
      const mermaidSource = mermaidDiv.textContent;

      // Create container wrapper
      const container = document.createElement('div');
      container.className = 'mermaid-container';

      // Create copy button
      const copyBtn = document.createElement('button');
      copyBtn.className = 'mermaid-copy-btn';
      copyBtn.textContent = 'Copy Mermaid Code';
      copyBtn.setAttribute('title', 'Copy diagram code for Draw.io, Mermaid Live, etc.');

      copyBtn.addEventListener('click', function() {
        navigator.clipboard.writeText(mermaidSource).then(function() {
          copyBtn.textContent = 'Copied!';
          copyBtn.classList.add('copied');

          setTimeout(function() {
            copyBtn.textContent = 'Copy Mermaid Code';
            copyBtn.classList.remove('copied');
          }, 2000);
        });
      });

      // Wrap the mermaid div in container and add button
      mermaidDiv.parentNode.insertBefore(container, mermaidDiv);
      container.appendChild(mermaidDiv);
      container.appendChild(copyBtn);
    });
  });
</script>
    <script src="../../js/main.js"></script>

            </div>
        </div>
    </div>

    <!-- Footer -->
    <div id="footer-placeholder"></div>

    <!-- Back to Top Button -->
    <button id="backToTopBtn" title="Go to top">
        <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24">
            <path d="M0 0h24v24H0V0z" fill="none"/>
            <path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6 1.41 1.41z"/>
        </svg>
    </button>

    <script src="../../js/includes-loader.js"></script>
  </body>
